
<!DOCTYPE html>
<html class="borderbox" >
    
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    2020å¹´10æœˆ07æ—¥æ‚è®° | DouO's Note</title>
  <meta name="description" content="æœ‰æ™‚æ¨¹æœƒå€’ä¸‹ï¼ŒæŸç‰‡å¤©é ƒåˆ»æ˜äº®
">

  <!-- Favicon -->
  <link rel="shortcut icon" href="/assets/images/favicon.ico" type="image/x-icon" />
  <!-- Windows 8 Tile Icons -->
  <meta name="application-name" content=" Blog">
  <meta name="msapplication-TileColor" content="#5d4d7a">
  <meta name="msapplication-square70x70logo" content="smalltile.png" />
  <meta name="msapplication-square150x150logo" content="mediumtile.png" />
  <meta name="msapplication-wide310x150logo" content="widetile.png" />
  <meta name="msapplication-square310x310logo" content="largetile.png" />
  <!-- Android Lolipop Theme Color -->
  <meta name="theme-color" content="#5d4d7a">
  <link rel="stylesheet" href="/assets/main.css">
  <script src="/assets/main.js"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  </head>

    <body>
        <header>
  <nav class="top-nav">
    <div class="container">
      <div class="nav-wrapper">
        <div class="row">
          <div class="col s12 m10 offset-m1">
            <h1 class="header">2020å¹´10æœˆ07æ—¥æ‚è®°</h1>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <div class="container"><a href="#" data-target="nav-mobile" class="top-nav sidenav-trigger full hide-on-large-only"><i class="material-icons">menu</i></a></div>
  <ul id="nav-mobile" class="sidenav sidenav-fixed">
    <li>
      <div class="logo">
        <a id="logo-container" href="/notes" class="brand-logo">
          <object id="front-page-logo" type="image/svg+xml">Your browser does not support SVG</object>
        </a>
        <div class="social">
          
          <a href="/rss.xml" title="è®¢é˜…">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-feed"></use>
            </svg>
          </a>
          
          <a href="https://github.com/douo" title="Github">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-github"></use>
            </svg>
          </a>
          
          <a href="https://stackoverflow.com/users/851344/douo" title="StackOverflow">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-stack-overflow"></use>
            </svg>
          </a>
          
          <a href="https://plus.google.com/102537448648560113422" title="Google Plus">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-google-plus"></use>
            </svg>
          </a>
          
          <a href="https://instagram.com/douo" title="Instagram">
            <svg class="icon" aria-hidden="true">
              <use xlink:href="#icon-instagram"></use>
            </svg>
          </a>
          
        </div>
    </li>
    </div>
    <li class="search">
      <div class="search-wrapper">
        <input id="search" placeholder="Search"><i class="material-icons">search</i>
        <div class="search-results"></div>
      </div>
    </li>
    <li class="no-padding">
      <div id="blog-nav">
        <ul>
          
          <li><a href="/">ä¸»é¡µ</a></li>
          
          <li><a href="/notes">ç¬”è®°</a></li>
          
          <li><a href="/categories#coder-ref">ç¼–ç </a></li>
          
          <li><a href="/categories#life-ref">ç”Ÿæ´»</a></li>
          
          <li><a href="/categories#otaku-ref">å…´è¶£</a></li>
          
          <li><a href="/tags">æ ‡ç­¾</a></li>
          
          <li><a href="/log">æ—¥å¿—</a></li>
          
          <li><a href="/help">å¸®åŠ©</a></li>
          
          <li><a href="/about">å…³äº</a></li>
          
        </ul>
      </div>
      <div id="note-nav"></div>
    </li>
  </ul>
  <div id="nav-tab" class="hide-on-med-and-down">
    <div class="row">
      <ul class="tabs">
        <li class="tab col s6"><a href="#blog-nav">åšå®¢</a></li>
        <li class="tab col s6"><a href="#note-nav">ç¬”è®°</a></li>
      </ul>
    </div>
  </div>
</header>
<!-- Page Layout here -->
<main><div class="container">
  <div class="row">

    <div class="content col s12 m8 offset-m1 xl7 offset-xl1"> <div class="post-meta">
<span class="post-date tooltipped" data-tooltip="æœ€åæ›´æ–° 20-11-16">2020-10-07</span>
    
</div>

<article>
    <h2 id="go">go</h2>

<p>golang æœ€åç›´è§‰çš„å°±æ˜¯ GOPATH http://c.biancheng.net/view/4773.html</p>

<p>å¹¸å¥½æœ‰äº† go mod</p>

<h3 id="é¡¹ç›®ç»“æ„">é¡¹ç›®ç»“æ„</h3>

<p>repository -&gt; module  -&gt; packages(a collection of source files in the same directory that are compiled together)</p>

<p>go ä¸æ”¯æŒèŒƒå‹</p>

<p>åœ¨ Go ä¸­ï¼Œå¦‚æœä¸€ä¸ªåå­—ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯å·²å¯¼å‡ºçš„ã€‚ä»»ä½•â€œæœªå¯¼å‡ºâ€çš„åå­—åœ¨è¯¥åŒ…å¤–å‡æ— æ³•è®¿é—®ã€‚</p>

<p>å˜é‡éœ€è¦å£°æ˜å¯ç”¨ <code>var</code>ï¼Œä¹Ÿå¯ä»¥ç”¨çŸ­å˜é‡å£°æ˜ <code>:=</code>ï¼ˆç±»å‹æ¨å¯¼ï¼‰ ä½†ä¸èƒ½åœ¨å‡½æ•°ä½“å¤–ä½¿ç”¨ï¼Œä¹Ÿæœ‰å¸¸é‡å…³é”®å­— const</p>

<p>å¤šè¿”å›å€¼ï¼šå‡½æ•°å¯ä»¥è¿”å›å¤šä¸ªä¸åŒç±»å‹çš„ç»“æœã€‚</p>

<p>Go åœ¨ä¸åŒç±»å‹çš„é¡¹ä¹‹é—´èµ‹å€¼æ—¶éœ€è¦æ˜¾å¼è½¬æ¢ã€‚</p>

<p>å¾ªç¯ç»“æ„ï¼šGo åªæœ‰ä¸€ç§å¾ªç¯ç»“æ„ï¼šfor å¾ªç¯ï¼Œç±» c çš„è¯­æ³•ï¼Œåªä¸è¿‡æ›´çµæ´» æ”¯æŒ  <code>for sum &lt; 1 {}</code>ã€<code>for {}</code></p>

<p>æ¡ä»¶è¯­å¥ï¼š</p>

<ul>
  <li>if æ— éœ€å°æ‹¬å·</li>
  <li>switch caseï¼Œåªè¿è¡Œä¸€ä¸ª caseï¼Œæ”¯æŒæ— æ¡ä»¶ switchï¼ˆç­‰åŒ if-elseï¼‰</li>
</ul>

<p><code>defer</code> è¯­å¥ä¼šå°†å‡½æ•°æ¨è¿Ÿåˆ°å¤–å±‚å‡½æ•°è¿”å›ä¹‹åæ‰§è¡Œã€‚defer æ˜¯ä¸€ä¸ªæ ˆ</p>

<h3 id="æŒ‡é’ˆ">æŒ‡é’ˆ</h3>

<ul>
  <li>å€¼ç±»å‹ <code>Type</code>ï¼Œå¯¹åº”æŒ‡é’ˆç±»å‹ <code>*Type</code></li>
  <li>å–æŒ‡ <code>ptr = &amp;value</code></li>
  <li>å–å€¼ <code>value = *ptr</code></li>
</ul>

<h3 id="æ•°ç»„">æ•°ç»„</h3>

<ul>
  <li>æ•°ç»„åœ¨åˆå§‹åŒ–ä¹‹åå¤§å°å°±æ— æ³•æ”¹å˜</li>
  <li>
    <p>å­˜å‚¨å…ƒç´ ç±»å‹ç›¸åŒã€ä½†æ˜¯å¤§å°ä¸åŒçš„æ•°ç»„ç±»å‹åœ¨ Go è¯­è¨€çœ‹æ¥ä¹Ÿæ˜¯å®Œå…¨ä¸åŒçš„ï¼Œåªæœ‰ä¸¤ä¸ªæ¡ä»¶éƒ½ç›¸åŒæ‰æ˜¯åŒä¸€ä¸ªç±»å‹ã€‚</p>

    <pre><code>  var a [10]int // é»˜è®¤å–é›¶å€¼
  primes := [6]int{2, 3, 5, 7, 11, 13}
  primes := [...]int{2, 3, 5, 7, 11, 13} // [...]T å£°æ˜æ•°ç»„ï¼Œè¯­æ³•ç³–ã€‚Go è¯­è¨€ä¼šåœ¨ç¼–è¯‘æœŸé—´é€šè¿‡æºä»£ç å¯¹æ•°ç»„çš„å¤§å°è¿›è¡Œæ¨æ–­
</code></pre>
  </li>
</ul>

<h3 id="åˆ‡ç‰‡">åˆ‡ç‰‡</h3>

<p>è¿è¡Œæ—¶åˆ‡ç‰‡ç”±å¦‚ä¸‹çš„ SliceHeader ç»“æ„ä½“è¡¨ç¤ºï¼Œå…¶ä¸­ Data å­—æ®µæ˜¯æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼ŒLen è¡¨ç¤ºå½“å‰åˆ‡ç‰‡çš„é•¿åº¦ï¼Œè€Œ Cap è¡¨ç¤ºå½“å‰åˆ‡ç‰‡çš„å®¹é‡ï¼Œä¹Ÿå°±æ˜¯ Data æ•°ç»„çš„å¤§å°</p>

<pre><code>type SliceHeader struct {
	Data uintptr
	Len  int
	Cap  int
}
</code></pre>

<p>åˆ‡ç‰‡è¿ç®—</p>

<pre><code>a[low : high]  //[low,high)
</code></pre>

<p>åˆ‡ç‰‡æ–‡æ³•ï¼Œåˆ‡ç‰‡æ–‡æ³•ç±»ä¼¼äºæ²¡æœ‰é•¿åº¦çš„æ•°ç»„æ–‡æ³•</p>

<pre><code>[]bool{true, true, false}
slice := make([]int, 10)
</code></pre>

<p>åœ¨è¿›è¡Œåˆ‡ç‰‡æ—¶ï¼Œä½ å¯ä»¥åˆ©ç”¨å®ƒçš„é»˜è®¤è¡Œä¸ºæ¥å¿½ç•¥ä¸Šä¸‹ç•Œã€‚åˆ‡ç‰‡ä¸‹ç•Œçš„é»˜è®¤å€¼ä¸º 0ï¼Œä¸Šç•Œåˆ™æ˜¯è¯¥åˆ‡ç‰‡çš„é•¿åº¦ã€‚
åˆ‡ç‰‡çš„é›¶å€¼æ˜¯ nilã€‚</p>

<p>å¯é€šè¿‡ append å‡½æ•°æ‰©å±•capã€‚ç±»ä¼¼å…¶ä»–è¯­è¨€çš„ list</p>

<pre><code>for i, v := range pow {
	fmt.Printf("2**%d = %d\n", i, v)
}
</code></pre>

<h3 id="make--new">make &amp; new</h3>

<ul>
  <li>make çš„ä½œç”¨æ˜¯åˆå§‹åŒ–å†…ç½®çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨å‰é¢æåˆ°çš„åˆ‡ç‰‡ã€å“ˆå¸Œè¡¨å’Œ Channel2ï¼›</li>
  <li>new çš„ä½œç”¨æ˜¯æ ¹æ®ä¼ å…¥çš„ç±»å‹åˆ†é…ä¸€ç‰‡å†…å­˜ç©ºé—´å¹¶è¿”å›æŒ‡å‘è¿™ç‰‡å†…å­˜ç©ºé—´çš„æŒ‡é’ˆ3ï¼›</li>
</ul>

<h3 id="hashmap">hashmap</h3>

<p><code>map</code></p>

<pre><code>m = make(map[string]Vertex)

var m = map[string]Vertex{
"Bell Labs": Vertex{
	40.68433, -74.39967,
},
"Google": {  //Vertex å¯çœç•¥
	37.42202, -122.08408,
}, }
</code></pre>

<h3 id="function">function</h3>

<p>go å‡½æ•°çš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥è¿”å›å¤šä¸ªå€¼ï¼Œgo ä½¿ç”¨æ ˆä¼ é€’å‚æ•°å’Œæ¥æ”¶è¿”å›å€¼ï¼Œæ‰€ä»¥å®ƒåªéœ€è¦åœ¨æ ˆä¸Šå¤šåˆ†é…ä¸€äº›å†…å­˜å°±å¯ä»¥è¿”å›å¤šä¸ªå€¼ã€‚</p>

<p>å‚æ•°ä¼ å€¼è€Œä¸æ˜¯ä¼ å¼•ç”¨ã€‚ä¼ é€’ç»“æ„ä½“æ—¶ï¼šä¼šå¯¹ç»“æ„ä½“ä¸­çš„å…¨éƒ¨å†…å®¹è¿›è¡Œæ‹·è´ï¼›ä¼ é€’ç»“æ„ä½“æŒ‡é’ˆæ—¶ï¼šä¼šå¯¹ç»“æ„ä½“æŒ‡é’ˆè¿›è¡Œæ‹·è´ï¼›</p>

<p>go çš„å‡½æ•°å°±æ˜¯ä¸€ä¸ªé—­åŒ…</p>

<h3 id="é¢å‘å¯¹è±¡">é¢å‘å¯¹è±¡</h3>

<p>go æ²¡æœ‰ç±»å…³é”®å­—ã€‚</p>

<p>ç”¨ struct ä½œä¸º data class</p>

<pre><code>type Student struct {
    Name string
    Age  int
}
</code></pre>

<p>åˆ›å»ºå¯¹è±¡ï¼š</p>

<pre><code>var a Student    // a == Student{"", 0}  ç›´æ¥åˆ›å»ºä¸€ä¸ªé›¶å€¼å¯¹è±¡ï¼Œè¿”å›çš„æ˜¯å€¼å¼•ç”¨
a.Name = "Alice" // a == Student{"Alice", 0}

var pa *Student   // pa == nil
pa = new(Student) // pa == &amp;Student{"", 0} è¿”å›çš„æ˜¯æŒ‡é’ˆ
pa.Name = "Alice" // pa == &amp;Student{"Alice", 0}
</code></pre>

<p>å¦ä¸€ä¸ªä¾‹å­ï¼š</p>

<pre><code>type Vertex struct {
    X int
    Y int
}
</code></pre>

<p>æ„é€ </p>

<pre><code>var (
	v1 = Vertex{1, 2}  // åˆ›å»ºä¸€ä¸ª Vertex ç±»å‹çš„ç»“æ„ä½“
	v2 = Vertex{X: 1}  // Y:0 è¢«éšå¼åœ°èµ‹äºˆ
	v3 = Vertex{}      // X:0 Y:0
	p  = &amp;Vertex{1, 2} // åˆ›å»ºä¸€ä¸ª *Vertex ç±»å‹çš„ç»“æ„ä½“ï¼ˆæŒ‡é’ˆï¼‰
)
</code></pre>

<p>æ— è®ºæ˜¯å€¼è¿˜æ˜¯æŒ‡é’ˆå¼•ç”¨ï¼Œéƒ½æ˜¯ç”¨åŒæ ·çš„è¯­æ³•è®¿é—®å±æ€§ï¼Œè¿™æ˜¯ä¸ª<strong>è¯­æ³•ç³–</strong>ä¸æ³¨æ„çš„è¯å¾ˆå®¹æ˜“è¿·æƒ‘ã€‚</p>

<p>è¿˜å¯ä»¥é€šè¿‡ struct å­—é¢é‡åˆ›å»ºå¯¹è±¡ï¼š</p>

<pre><code>b := Student{ // b == Student{"Bob", 0}
    Name: "Bob",
}

pb := &amp;Student{ // pb == &amp;Student{"Bob", 8}
    Name: "Bob",
    Age:  8,
}
</code></pre>

<p>é€šè¿‡å¯¹å‡½æ•°æ·»åŠ æ¥æ”¶è€…ï¼Œè®©å…¶å˜ä¸ºæ¥æ”¶è€…çš„æ–¹æ³•ã€‚</p>

<pre><code>func (v Vertex) Abs() float64 {
	return math.Sqrt(v.X*v.X + v.Y*v.Y)
}
</code></pre>

<p>æ–¹æ³•åªæ˜¯ä¸ªå¸¦æ¥æ”¶è€…å‚æ•°çš„å‡½æ•°ã€‚çœ‹ä¼¼å¾ˆè®¨å·§ï¼ˆé¿å… NPEï¼‰ï¼Œä¸è¿‡è²Œä¼¼å®ä¾‹æ–¹æ³•å¤šèµ·æ¥ï¼Œè¿˜æ˜¯å¾ˆç¹ççš„ã€‚</p>

<p>çœ‹èµ·æ¥ç±»ä¼¼ kotlin çš„ extensionï¼Œ ruby çš„  open class ã€‚ä½†å®é™…ä¸Š** func ä¸æ¥æ”¶è€…å¿…é¡»åœ¨åŒä¸€ä¸ªåŒ…ä¸‹**ï¼Œè¿™ä¹Ÿå°±æ–­äº†å®ç° kotlin extension method çš„è·¯ã€‚</p>

<p>mutable æ–¹æ³•ï¼Œéœ€è¦ç”¨åˆ°æŒ‡é’ˆæ¥æ”¶è€…</p>

<pre><code>func (v *Vertex) Scale(f float64) {
	v.X = v.X * f
	v.Y = v.Y * f
}
</code></pre>

<p>æ¥å£ç±»å‹ æ˜¯ç”±ä¸€ç»„æ–¹æ³•ç­¾åå®šä¹‰çš„é›†åˆã€‚</p>

<p>type Abser interface {
	Abs() float64
}</p>

<p>go çš„æ¥å£å®ç°æ˜¯éšå¼çš„ï¼Œå…¶å®ä¹Ÿæ˜¯æ–¹æ³•æŒ‡å®šæ¥æ”¶è€…è¿™ç§è®¾è®¡å†³å®šã€‚å¥½åƒå«åšé¸­å­ç±»å‹</p>

<h4 id="ç±»å‹æ–­è¨€">ç±»å‹æ–­è¨€</h4>

<pre><code>t, ok := i.(T)
</code></pre>

<p>ç±»ä¼¼å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œè‹¥ i ä¿å­˜äº†ä¸€ä¸ª Tï¼Œé‚£ä¹ˆ t å°†ä¼šæ˜¯å…¶åº•å±‚å€¼ï¼Œè€Œ ok ä¸º trueã€‚å¦åˆ™ï¼Œok å°†ä¸º false è€Œ t å°†ä¸º T ç±»å‹çš„é›¶å€¼ï¼Œç¨‹åºå¹¶<strong>ä¸ä¼šäº§ç”Ÿææ…Œ</strong>ã€‚</p>

<h4 id="ç±»å‹é€‰æ‹©">ç±»å‹é€‰æ‹©</h4>

<pre><code>switch v := i.(type) {
case T:
    // v çš„ç±»å‹ä¸º T
case S:
    // v çš„ç±»å‹ä¸º S
default:
    // æ²¡æœ‰åŒ¹é…ï¼Œv ä¸ i çš„ç±»å‹ç›¸åŒ
}
</code></pre>

<h3 id="å¼‚å¸¸æœºåˆ¶">å¼‚å¸¸æœºåˆ¶</h3>

<h4 id="check-exception">Check Exception</h4>

<p>æ²¡æœ‰ try-catch æœºåˆ¶ï¼Œæ²¡æœ‰ç±» throw çš„æœºåˆ¶ï¼Œé”™è¯¯é€šè¿‡å‡½æ•°çš„å¤šè¿”å›å€¼å®ç° Eitherï¼Œå‡ºé”™æ—¶æå‰è¿”å›é€€å‡ºå‡½æ•°ã€‚</p>

<p>å£°æ˜ä¸€ä¸ªå‡½æ•°ä¼šè¿”å›é”™è¯¯ï¼š</p>

<pre><code>func Open(name string) (file *File, err error)
</code></pre>

<p>é”™è¯¯å¤„ç†ï¼š</p>

<pre><code>f, err := os.Open("filename.ext")
if err != nil {
    log.Fatal(err)
}
// do something with the open *File f
</code></pre>

<p>æ„Ÿè§‰å’Œ java çš„ check exception æœ‰ç‚¹æ®Šé€”åŒå½’çš„æ„æ€ï¼Œä¸è¿‡ç”¨èµ·æ¥ä¹Ÿæ˜¯åŒæ ·ç¹çã€‚</p>

<p>åˆ›å»º error çš„ä¸¤ç§æ–¹æ³•ï¼š <code>fmt.Errorf</code>ã€<code>errors.New</code>ã€‚<code>error</code> å°±æ˜¯ä¸€ä¸ªå®ç°å¦‚ä¸‹æ¥å£çš„ç±»ï¼š</p>

<pre><code>type Error interface{
    func Error() string
}
</code></pre>

<p>é—®é¢˜ï¼Œ</p>
<ol>
  <li>ä¸€ä¸ªæ“ä½œå¤šä¸ªè°ƒç”¨éƒ½å¯èƒ½æŠ›å‡º errï¼Œå¦‚ä½•ä¼˜é›… D å¤„ç†</li>
  <li>è¿”å›çš„ err ä¸§å¤±è°ƒç”¨æ ˆçš„ä¿¡æ¯ï¼Œå¤šå±‚è¿”å›åä¸çŸ¥é“å“ªä¸ªå‡½æ•°æˆ–å“ªè¡Œä»£ç æŠ›å‡ºã€‚</li>
</ol>

<h4 id="wrap-error">Wrap Error</h4>

<p>å¯è§ go ä¸€å¼€å§‹çš„é”™è¯¯æœºåˆ¶è®¾è®¡è¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜äº†ï¼Œgo 1.13 åï¼Œåšäº†æ›´æ–°ï¼š</p>

<p><a href="https://blog.golang.org/go1.13-errors">Working with Errors in Go 1.13 - The Go Blog</a></p>

<ul>
  <li>ä½¿ç”¨ wrap error çš„ç›®çš„ï¼Œä¸ºäº†ä¼ é€’æ›´å¤šçš„å‡ºé”™ä¿¡æ¯æˆ–ä¸Šä¸‹æ–‡</li>
  <li>wrap error æ³¨æ„é¿å…æš´éœ²å®ç°ç»†èŠ‚ï¼Œç‰¹åˆ«æ˜¯ä¸è¦å¾’å¢ä¾èµ–</li>
</ul>

<h4 id="runtime-exception">Runtime Exception</h4>

<p>å¯¹äºæ•°ç»„è¶Šç•Œï¼Œç©ºæŒ‡é’ˆä¹‹ç±»çš„ runtime å¼‚å¸¸ï¼Œç®€å•çš„è¯´ä¼šæŠ›å‡ºï¼ˆè°ƒç”¨ï¼‰ä¸€ä¸ª <code>panic</code>ï¼Œ <code>panic</code> æ˜¯ä¸€ä¸ªå†…å»ºå‡½æ•°ï¼Œè°ƒç”¨å®ƒä¼šåœæ­¢å½“å‰å‡½æ•°çš„æ‰§è¡Œï¼ˆä¹‹å‰å£°æ˜çš„ defer ä¼šç»§ç»­æ‰§è¡Œï¼‰ï¼Œå¹¶æ²¿è°ƒç”¨æ ˆä¸€å±‚å±‚æŠ›å‡ºï¼Œç›´åˆ°é‡åˆ° <code>recover</code>ã€‚ <code>recover</code> ä¹Ÿæ˜¯å†…å»ºå‡½æ•°ï¼Œè¿”å› panic æºå¸¦çš„æ¶ˆæ¯ï¼ˆstringï¼‰ï¼ŒåŒæ—¶ä¼šè®© <code>goroutine</code> å›åˆ°æ­£å¸¸çš„æ§åˆ¶æµï¼Œä¹Ÿå°±æ˜¯é˜»æ­¢äº† <code>panic</code> çš„ç»§ç»­å‘ä¸Šä¼ æ’­ã€‚<code>recover</code> åªèƒ½åœ¨ <code>defer</code> å†…æ‰§è¡Œ</p>

<pre><code>func main() {
	g()
	println("after g")
}

func g() {
	defer func() {
		println("defer")
		if r := recover(); r != nil {
			fmt.Printf("Recovered in g:%T %v \n", r, r)
		}
	}()
	panic("wtf")
}
</code></pre>

<p>è¾“å‡ºï¼š</p>

<pre><code>defer
Recovered in g:string wtf
after g
</code></pre>

<p><a href="https://blog.golang.org/defer-panic-and-recover">Defer, Panic, and Recover - The Go Blog</a></p>

<p><code>runtime/debug</code> å¯ä»¥è®¿é—®è°ƒç”¨æ ˆ</p>

<h4 id="å¦‚ä½•é¿å…è¿‡å¤šçš„-if-err">å¦‚ä½•é¿å…è¿‡å¤šçš„ <code>if err</code></h4>

<h2 id="goroutine">goroutine</h2>

<p><code>go</code> ç›¸å½“äº coroutine çš„ <code>launch {}</code></p>

<pre><code>channel ch := make(chan int)
ch &lt;- v    // å°† v å‘é€è‡³ä¿¡é“ chã€‚
v := &lt;-ch  // ä» ch æ¥æ”¶å€¼å¹¶èµ‹äºˆ v
</code></pre>

<p><code>select</code>  ä¼šé˜»å¡åˆ°æŸä¸ªåˆ†æ”¯å¯ä»¥ç»§ç»­æ‰§è¡Œä¸ºæ­¢ï¼Œè¿™æ—¶å°±ä¼šæ‰§è¡Œè¯¥åˆ†æ”¯ã€‚å½“å¤šä¸ªåˆ†æ”¯éƒ½å‡†å¤‡å¥½æ—¶ä¼šéšæœºé€‰æ‹©ä¸€ä¸ªæ‰§è¡Œã€‚</p>

<pre><code>select {
case i := &lt;-c:
    // ä½¿ç”¨ i
}
</code></pre>

<p>select æ§åˆ¶ç»“æ„ä¸­åŒ…å« default è¯­å¥ï¼Œé‚£ä¹ˆè¿™ä¸ª select è¯­å¥åœ¨æ‰§è¡Œæ—¶ä¼šé‡åˆ°ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š</p>

<ul>
  <li>å½“å­˜åœ¨å¯ä»¥æ”¶å‘çš„ Channel æ—¶ï¼Œç›´æ¥å¤„ç†è¯¥ Channel å¯¹åº”çš„ caseï¼›</li>
  <li>å½“ä¸å­˜åœ¨å¯ä»¥æ”¶å‘çš„ Channel æ˜¯ï¼Œæ‰§è¡Œ default ä¸­çš„è¯­å¥ï¼›</li>
</ul>

<p>ä¹Ÿå°±å˜æˆéé˜»å¡çš„ã€‚</p>

<p>Mutex, goroutine çš„é”</p>

<pre><code>// Value è¿”å›ç»™å®š key çš„è®¡æ•°å™¨çš„å½“å‰å€¼ã€‚
func (c *SafeCounter) Value(key string) int {
	c.mux.Lock()
	// Lock ä¹‹ååŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ª goroutine èƒ½è®¿é—® c.v
	defer c.mux.Unlock()
	return c.v[key]
}
</code></pre>

<h2 id="suid-sgid">SUID SGID</h2>

<p>suid åªèƒ½ç”¨äºæ–‡ä»¶</p>

<p>ç»™ç›®å½•è®¾ç½® sgid å¯ä»¥è®©å…¶ä»–ç”¨æˆ·åœ¨è¯¥ç›®å½•ä¸‹åˆ›å»ºçš„æ–‡ä»¶ç»§æ‰¿è¯¥ç›®å½•çš„ç»„æƒé™</p>

<pre><code>sudo chmod g+s /usr/local/bin/htg # ğŸ åŠ  sgid bit
</code></pre>

<h2 id="nethttp">net/http</h2>

<p>åº•å±‚å®ç°åœ¨ transport.go</p>

<h2 id="tips">Tips</h2>

<ol>
  <li>bolierplate ç®—ä¸äº†ä»€ä¹ˆï¼Œå¯è¯»æ€§æ‰æ˜¯ç‹é“</li>
  <li>å¦‚ä½•é€‰æ‹© value or pointer reciever</li>
  <li>go ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œä½†å†…ç½®çš„ <code>make</code> å‡½æ•°å´æ˜¯é‡è½½çš„</li>
</ol>

<p><a href="https://github.com/golang-standards/project-layout/blob/master/README_zh.md">project-layout/README_zh.md at master Â· golang-standards/project-layout</a></p>

</article>
<div class="tag-container" >
    
</div>


<div id="disqus_thread"></div>
<script>

 /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
 var jekyll_id = "/notes/Quick/2020/10/note-2020-10-07"
 var disqus_config = function () {
     this.page.title = "2020å¹´10æœˆ07æ—¥æ‚è®°"
     this.page.identifier = "posts"+jekyll_id.substring(jekyll_id.lastIndexOf('/'))+".md"; // required: replace example with your forum shortname
     console.log(this.page.identifier);
     this.page.url = "http://dourok.info/notes/Quick/2020/10/note-2020-10-07/";
    };

 (function() { // DON'T EDIT BELOW THIS LINE
     var d = document, s = d.createElement('script');
     s.src = '//doousblog.disqus.com/embed.js';
     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




<a class="btn-floating btn-large waves-effect waves-light scale-transition fab" id="fab"><i class="material-icons">keyboard_arrow_up</i></a>
</div>
    <div class="col hide-on-small-only m1 xl1 ">
        <a class="btn-floating teal" id='toc-toggle'><i id='toc-toogle-icon' class="material-icons">compare_arrows</i></a>
      </div>
    <div class="col hide-on-small-only m3 xl3 offset-xl1 toc-wrapper">
      <ul class="section table-of-contents">
      </ul>
    </div>
  </button>
</div>
</main>

<footer>
    <div class="container">
        <div class="row">
            <div class="col s12 m5 offset-m1">
                <h5>å‹æƒ…é“¾æ¥</h5>
                <ul class="mdl-mega-footer__link-list">
                    
                    <li><a href="https://magicalboy.com/">MAGICALBOY</a></li>
                    
                    <li><a href="http://www.cnlvzi.com/">é©´å­åšå®¢</a></li>
                    
                </ul>
            </div>
            <div class="col s12 m5">
                <div class="footer-nav">
                    
                    <a href="/">ä¸»é¡µ</a>
                    
                    <a href="/notes">ç¬”è®°</a>
                    
                    <a href="/categories#coder-ref">ç¼–ç </a>
                    
                    <a href="/categories#life-ref">ç”Ÿæ´»</a>
                    
                    <a href="/categories#otaku-ref">å…´è¶£</a>
                    
                    <a href="/tags">æ ‡ç­¾</a>
                    
                    <a href="/log">æ—¥å¿—</a>
                    
                    <a href="/help">å¸®åŠ©</a>
                    
                    <a href="/about">å…³äº</a>
                    
                </div>
        </div>
        </div>
    </div>
    <div class="footer-copyright">
        <div class="container">
            <div class="row">
                <div class="col offset-m1">
                    Â©2009-ä¸–ç•Œæœ«æ—¥ | åŸºæ–¼ <a href="https://jekyllrb.com">Jekyll</a> | ä¸»é¢˜ <a href="#">Moon</a> | <small class="license">
	                  <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh"><img title="çŸ¥è¯†å…±äº«è®¸å¯åè®®" style="border-width: 0px; vertical-align: middle; display: inline; " src="https://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png" original="https://i.creativecommons.org/l/by-nc-sa/3.0/80x15.png"></a>
	                  </small>
                </div>
            </div>
        </div>
    </div>
</footer>



        

        

        
    </body>

</html>
